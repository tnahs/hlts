{% macro current(page) -%}

	{% if request.endpoint == page %} current {% endif %}

{% endmacro %}

{% macro icon(name) -%}

	{% set class_ = name ~ 'Icon' %}

	{% if request.endpoint.split('.')[-1] == name %}
		{% set filename = 'images/icon_' ~ name ~ '_current.png' %}
	{% else %}
		{% set filename = 'images/icon_' ~ name ~ '.png' %}
	{% endif %}

	<img class="{{ class_ }}" src="{{ url_for('static', filename=filename) }}"/>

{% endmacro %}


<nav>

	<mainMenu>

		<a class="{{ current('main.dashboard') }}" href="{{ url_for('main.dashboard') }}">{{ icon("dashboard") }}</a>
		<a class="{{ current('main.dashboard') }}" href="{{ url_for('main.dashboard') }}">dashboard</a>
		<a class="{{ current('main.index') }}" href="{{ url_for('main.index', mode='default')}}">index</a>
		<a class="{{ current('main.recent') }}" href="{{ url_for('main.recent', mode='default') }}">recent</a>
		<a class="{{ current('main.add') }}" href="{{ url_for('main.add') }}">{{ icon("add") }}</a>
		<a class="{{ current('main.tools') }}" href="{{ url_for('main.tools') }}">{{ icon("tools") }}</a>
		<a class="{{ current('main.trash') }}" href="{{ url_for('main.trash') }}">{{ icon("trash") }}</a>

	</mainMenu>

	<searchMenu>

		{{ icon("search") }}

		{% if request.endpoint == "main.search" %}

			{% set search = request.args.get('search') %}

		{% endif %}

		<form action="{{ url_for('main.search') }}" method="GET">
			<input type="text" name="search" value="{{ search }}"/>
		</form>

	</searchMenu>

	<userMenu>

		{% set display_name = current_user.fullname if current_user.fullname else current_user.username %}

		<div class="text upper faded">{{ display_name }}</div>
		<a href="{{ url_for('user.settings') }}">{{ icon("settings") }}</a>

	</userMenu>

	<flash>

		{% with messages = get_flashed_messages(with_categories=true) %}

			{% if messages %}

				{% for category, message in messages %}

						<div class="window {{ category }}">

							<div class="message text upper">{{ message }}</div>

							<a href="#" class="link button close">âœ•</a>

						</div>

				{% endfor %}

			{% endif %}

		{% endwith %}

	</flash>

</nav>
